<html>
  <!-- Extremely simple example showing receiving HRM data from Bangle.js -->
  <head></head>
<body>
  <div style="width:404px;height:24px;border:1px solid black;">
    <div id="hrm" style="width:0px;height:20px;margin:2px;background-color:red"></div>
  </div>
  <button id="btn">Start</button>

  <script src="https://www.espruino.com/js/uart.js"></script>
  <script>
    document.getElementById("btn").addEventListener("click", function() {
      UART.write(`reset();\n`).then(function() {
        return UART.write(`Bangle.setHRMPower(1);
                  Bangle.on("HRM-raw", e => Bluetooth.println(e.raw))\n`,undefined,{noWait:true});
      }).then(function() {
        UART.getConnection().on("line", (line) => {
          console.log(line);
          document.getElementById("hrm").style.width =
            Math.min(400, (parseInt(line)-3000)/12)+"px";
        });
      });
    });
  </script>
</body>
</html>
